<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
	
<mapper namespace="ldg.mybatis">


<!-- 		<select id="userList"	resultType="User"
		parameterType="hashmap">
				select * from userlist
			<if test="num!=null">
				WHERE num = #{num}
			</if>
		</select>
		 -->
		
		<select id="getNextNumber"	resultType="int" >
			select boardser.nextval from dual
		</select>
		
		
		<insert id="insertUser"	parameterType="User">
			insert into userlist(num,userid,passwd,username,displayname,
			position,gender,hp,address,email,reg_date,bio)
			 values(#{num},#{userid},#{passwd},#{username},#{displayname},
			 #{position},#{gender},#{hp},#{address},#{email},sysdate,#{bio})
		</insert>
		
		
		<select id="confirmId" parameterType="hashmap" resultType="map">
			select userid from userlist where userid=#{userid}
		</select>
		
		<select id="login" parameterType="hashmap" resultType="map">
			select passwd FROM userlist WHERE userid=#{userid}
		</select>
		
		<select id="getUser2" parameterType="hashmap" resultType="User">
			select * from userlist where userid=#{userid} and passwd=#{passwd}
		</select>
		
		
		<select id="followCount" parameterType="hashmap" resultType="int">
			select nvl(count(*),0) from follow where myid=#{myid}
		</select>
		
		<select id="followerCount" parameterType="hashmap" resultType="int">
			select nvl(count(*),0) from follow where friendid=#{friendid}
		</select>
		
		<select id="followList" parameterType="hashmap" resultType="User">
		select u.* from userlist u, follow f where u.userid=f.friendid and f.myid=#{myid}
		</select>
		
		<select id="followerList" parameterType="hashmap" resultType="User">
		select u.* from userlist u, follow f where u.userid=f.myid and f.friendid=#{friendid}
		</select>
		
		<select id="getUserCount" resultType="int">
			select nvl(count(*),0) from userlist;
		</select>
		
		<select id="getUsers" parameterType="hashmap" resultType="User">
		select * from ( select rownum rnum,a.* from (select num,userid,passwd,username,displayname,
					position,gender,hp,address,email,reg_date,bio from userlist order by num desc) a ) where rnum between #{startRow} and #{endRow}
		</select>
		
		
</mapper>

